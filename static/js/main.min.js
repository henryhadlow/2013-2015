!function(a,b){"use strict";function c(a,b){for(var c=0,d=a.length,e=[];d>c;c++)e[c]=b(a[c],c);return e}function d(a){return a}function e(){}function f(){return!0}function g(a,f){var j=this,l=b;f=f||{},void 0!==a&&("string"==typeof a?(f.selector=a,a=void 0):"undefined"==typeof a.length&&(f=a,a=void 0)),this.viewportHeight=l.documentElement.clientHeight,this.selector=f.selector||".delayed-image-load",this.className=f.className||"image-replace",this.gif=l.createElement("img"),this.gif.src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7",this.gif.className=this.className,this.gif.alt="",this.lazyloadOffset=f.lazyloadOffset||0,this.scrollDelay=f.scrollDelay||250,this.onResize=f.hasOwnProperty("onResize")?f.onResize:!0,this.lazyload=f.hasOwnProperty("lazyload")?f.lazyload:!1,this.scrolled=!1,this.availablePixelRatios=f.availablePixelRatios||[1,2],this.availableWidths=f.availableWidths||h,this.onImagesReplaced=f.onImagesReplaced||e,this.widthsMap={},this.refreshPixelRatio(),this.widthInterpolator=f.widthInterpolator||d,this.gif.removeAttribute("height"),this.gif.removeAttribute("width"),"function"!=typeof this.availableWidths&&("number"==typeof this.availableWidths.length?this.widthsMap=g.createWidthsMap(this.availableWidths,this.widthInterpolator,this.devicePixelRatio):(this.widthsMap=this.availableWidths,this.availableWidths=i(this.availableWidths)),this.availableWidths=this.availableWidths.sort(function(a,b){return a-b})),a?(this.divs=c(a,d),this.selector=null):this.divs=c(l.querySelectorAll(this.selector),d),this.ready(f.onReady),this.changeDivsToEmptyImages(this.divs),k(function(){j.init()})}var h,i,j,k=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)};j=function(){return b.addEventListener?function(a,b,c){return a.addEventListener(b,c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}(),h=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736],i="function"==typeof Object.keys?Object.keys:function(a){var b,c=[];for(b in a)c.push(b);return c},g.prototype.scrollCheck=function(){var b=this,d=0,e=[];this.scrolled&&(c(this.divs,function(a){b.isPlaceholder(a)&&(++d,b.isThisElementOnScreen(a)&&e.push(a))}),0===d&&a.clearInterval(b.interval),this.changeDivsToEmptyImages(e),this.scrolled=!1)},g.prototype.init=function(){var a=this;this.initialized=!0;var b=f;this.lazyload?(this.registerScrollEvent(),this.scrolled=!0,a.scrollCheck(),b=function(b){return a.isPlaceholder(b)===!1}):this.checkImagesNeedReplacing(this.divs),this.onResize&&this.registerResizeEvent(b),this.onReady()},g.prototype.ready=function(a){this.onReady=a||e},g.prototype.createGif=function(a){if(a.className.match(new RegExp("(^| )"+this.className+"( |$)")))return a;var b=a.getAttribute("data-class"),c=a.getAttribute("data-width"),d=this.gif.cloneNode(!1);return c&&(d.width=c,d.setAttribute("data-width",c)),d.className=(b?b+" ":"")+this.className,d.setAttribute("data-src",a.getAttribute("data-src")),d.setAttribute("alt",a.getAttribute("data-alt")||this.gif.alt),a.parentNode.replaceChild(d,a),d},g.prototype.changeDivsToEmptyImages=function(a){var b=this;c(a,function(c,d){a[d]=b.createGif(c)}),this.initialized&&this.checkImagesNeedReplacing(a)},g.prototype.isPlaceholder=function(a){return a.src===this.gif.src},g.prototype.isThisElementOnScreen=function(a){var b=0,c=g.getPageOffset()+this.lazyloadOffset;if(a.offsetParent)do b+=a.offsetTop;while(a=a.offsetParent);return b<this.viewportHeight+c},g.prototype.checkImagesNeedReplacing=function(a,b){var d=this;b=b||f,this.isResizing||(this.isResizing=!0,this.refreshPixelRatio(),c(a,function(a){b(a)&&d.replaceImagesBasedOnScreenDimensions(a)}),this.isResizing=!1,this.onImagesReplaced(a))},g.prototype.replaceImagesBasedOnScreenDimensions=function(a){var b,c;c=g.getNaturalWidth(a),b="function"==typeof this.availableWidths?this.availableWidths(a):this.determineAppropriateResolution(a),a.width=b,!this.isPlaceholder(a)&&c>=b||(a.src=this.changeImageSrcToUseNewImageDimensions(a.getAttribute("data-src"),b),a.removeAttribute("width"),a.removeAttribute("height"))},g.prototype.determineAppropriateResolution=function(a){return g.getClosestValue(a.getAttribute("data-width")||a.parentNode.clientWidth,this.availableWidths)},g.prototype.refreshPixelRatio=function(){this.devicePixelRatio=g.getClosestValue(g.getPixelRatio(),this.availablePixelRatios)},g.prototype.changeImageSrcToUseNewImageDimensions=function(a,b){return a.replace(/{width}/g,g.transforms.width(b,this.widthsMap)).replace(/{pixel_ratio}/g,g.transforms.pixelRatio(this.devicePixelRatio))},g.getPixelRatio=function(b){return(b||a).devicePixelRatio||1},g.createWidthsMap=function(a,b,c){for(var d={},e=a.length;e--;)d[a[e]]=b(a[e],c);return d},g.transforms={pixelRatio:function(a){return 1===a?"":"-"+a+"x"},width:function(a,b){return b[a]||a}},g.getClosestValue=function(a,b){var c=b.length,d=b[c-1];for(a=parseFloat(a);c--;)a<=b[c]&&(d=b[c]);return d},g.prototype.registerResizeEvent=function(b){var c=this;j(a,"resize",function(){c.checkImagesNeedReplacing(c.divs,b)})},g.prototype.registerScrollEvent=function(){var c=this;this.scrolled=!1,this.interval=a.setInterval(function(){c.scrollCheck()},c.scrollDelay),j(a,"scroll",function(){c.scrolled=!0}),j(a,"resize",function(){c.viewportHeight=b.documentElement.clientHeight,c.scrolled=!0})},g.getPageOffsetGenerator=function(c){return c?function(){return a.pageYOffset}:function(){return b.documentElement.scrollTop}},g.getNaturalWidth=function(){return"naturalWidth"in new Image?function(a){return a.naturalWidth}:function(a){var c=b.createElement("img");return c.src=a.src,c.width}}(),g.getPageOffset=g.getPageOffsetGenerator(Object.prototype.hasOwnProperty.call(a,"pageYOffset")),g.applyEach=c,"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=g:"function"==typeof define&&define.amd?define(function(){return g}):"object"==typeof a&&(a.Imager=g)}(window,document),new Imager({availableWidths:[200,260,320,600],lazyload:!0});